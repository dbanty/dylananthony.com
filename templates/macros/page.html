<!-- page listing macros -->
{% macro page_info(page, preview) %}
    <div>
        {% if page.extra.featured_image %}
            {% set image_path = page.components | join(sep="/") %}
            {% set image_path = image_path ~ "/" ~ page.extra.featured_image %}
            {% if preview %}
                {% set width=800 %}
                {% set height=500 %}
            {% else %}
                {% set width=1200 %}
                {% set height=800 %}
            {% endif %}
            {% set resized_featured_image = resize_image(path=image_path, width=width, height=height, op="fill", format="webp") %}
            <img
                    src="{{ resized_featured_image.static_path | replace(from="static", to="") }}"
                    alt="{{ page.extra.featured_image_alt }}"
                    width="{{ width }}" height="{{ height }}"
            />
        {% endif %}
        {% if page.date %}
            {% set reading_time = "â—¦ " ~ page.reading_time ~ " " ~ "min" %}
            <div class="text-center font-light">{{ page.date | date(format="%Y-%m-%d") }} {{ reading_time }} </div>
        {% endif %}
    </div>
{% endmacro page_info %}

{% macro tag_color(name) %}
    {%- if name == "Rust" -%}
        orange
    {%- elif name == "GraphQL" -%}
        fuchsia
    {%- elif name == "FastAPI" -%}
        teal
    {%- elif name == "serverless" -%}
        indigo
    {%- else -%}
        zinc
    {%- endif -%}
{% endmacro tag_color %}

{% macro page_tags(page) %}
{#    {% if page.taxonomies.categories %}#}
{#        {% set list = page.taxonomies.categories %}#}
{#        {% set kind="categories" %}#}
    {% if page.taxonomies.tags %}
        {% set list = page.taxonomies.tags %}
        {% set kind="tags" %}
    {% endif %}
    {% if list %}
        <div>
            {# divider for tags section #}
            <div class="border-t-2 border-zinc-400 dark:border-zinc-500 my-2"></div>
            {# Tags section #}
            <ul class="flex flex-auto place-content-evenly">
                {% for tag in list %}
                    {# Little clickable Tag pills #}
                    {% set color = self::tag_color(name=tag) %}
                    <li class="bg-{{ color }}-200 dark:bg-{{ color }}-700 hover:bg-{{ color }}-300 dark:hover:bg-{{ color }}-600
                                text-zinc-800 dark:text-zinc-100 hover:text-zinc-900 dark:hover:text-zinc-50
                                py-1 px-2 rounded-xl text-sm font-mono underline shadow-md
                                border border-1 border-dotted border-zinc-300 dark:border-zinc-400"><a
                            href="{{ get_taxonomy_url(kind=kind, name=tag) | safe }}"

                    >
                        <span class="font-semibold">#</span>{{ tag }}
                    </a></li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}
{% endmacro page_tags %}

{% macro card_style() %}
    rounded-md p-4 shadow-md cursor-pointer bg-white dark:bg-zinc-700
{% endmacro card_style %}

{% macro page_listing(page, preview) %}
    <article class="{{ self::card_style() }}"
             onclick="location.href='{{ page.path }}'">
        <a href="{{ page.path }}">
            <header>
                <h3 class="text-xl font-bold text-center">
                    {{ page.title }}
                </h3>
            </header>

            {% if page.summary %}
                <div class="content post-summary">
                    {{ page.summary | markdown | safe }}
                </div>
            {% endif %}
        </a>

        {{ self::page_info(page=page, preview=preview) }}
        {{ self::page_tags(page=page) }}
    </article>
{% endmacro page_listing %}

{% macro page_pagination(paginator) %}
    <nav class="font-mono mt-6 flex flex-row">
        {% if paginator.previous %}
            <a class="p-2 bg-zinc-50 dark:bg-zinc-700 rounded-lg"
               href="{{ paginator.previous }}">See newer posts ðŸ¦„</a>
        {% endif %}
        <div class="flex grow"></div>
        {% if paginator.next %}
            <a class="p-2 bg-zinc-50 dark:bg-zinc-700 rounded-lg"
               href="{{ paginator.next }}">See older posts ðŸ“œ</a>
        {% endif %}
    </nav>
{% endmacro page_pagination %}

<!-- project listing macros -->
{% macro project_listing(page) %}
    <article class="{{ self::card_style() }}"
             onclick="location.href='{{ page.path }}'">
        <a href="{{ page.path }}">
            <header>
                <h3 class="text-xl font-mono text-center mb-2">
                    {{ page.title }}
                </h3>
            </header>

            {% if page.summary %}
                <div class="content post-summary text-center">
                    {{ page.summary | markdown | safe }}
                </div>
            {% endif %}
        </a>

        {{ self::project_info(page=page) }}
        {{ self::page_tags(page=page) }}
    </article>
{% endmacro page_listing %}

{% macro project_info(page) %}
    <div>
        {% if page.date %}
            {% set reading_time = "â—¦ " ~ page.reading_time ~ " " ~ "min" %}
            <div class="text-center font-light">{{ page.date | date(format="%Y-%m-%d") }} {{ reading_time }} </div>
        {% endif %}
    </div>
{% endmacro project_info %}